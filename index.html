<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ»å·å¸‚åšç‰©é¦†æ¸¸å®¢æ»¡æ„åº¦è°ƒæŸ¥é—®å·</title>
    <style>
        :root {
            --primary-color: #2c5f2d; /* åšç‰©é¦†ç»¿ */
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-main: #333;
            --text-light: #666;
            --border-radius: 8px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            font-size: 24px;
            margin-bottom: 10px;
        }

        .intro {
            font-size: 14px;
            color: var(--text-light);
            text-align: justify;
            margin-bottom: 30px;
            padding: 15px;
            background: #f9f9f9;
            border-left: 4px solid var(--primary-color);
            border-radius: 4px;
        }

        .section-title {
            background-color: #eef5ef;
            color: var(--primary-color);
            padding: 10px 15px;
            border-radius: var(--border-radius);
            margin-top: 30px;
            margin-bottom: 20px;
            font-weight: bold;
            font-size: 18px;
        }

        .sub-section-title {
            color: var(--primary-color);
            font-size: 16px;
            font-weight: bold;
            margin: 20px 0 15px 0;
            padding: 8px 12px;
            border-left: 4px solid var(--primary-color);
            background: linear-gradient(90deg, rgba(44,95,45,0.1) 0%, transparent 100%);
        }

        .question-block {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .question-label {
            font-weight: 600;
            display: block;
            margin-bottom: 10px;
        }

        .question-help {
            font-size: 12px;
            color: #999;
            margin-top: 4px;
        }

        .required-mark {
            color: #e74c3c;
            margin-left: 4px;
        }

        /* é€‰é¡¹æ ·å¼ */
        .options-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .radio-label, .checkbox-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .radio-label:hover, .checkbox-label:hover {
            background-color: #f0f0f0;
        }

        input[type="radio"], input[type="checkbox"] {
            margin-right: 10px;
            accent-color: var(--primary-color);
            transform: scale(1.2);
        }

        /* æå…‹ç‰¹é‡è¡¨æ ·å¼ (1-5åˆ†) */
        .likert-scale {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            padding: 0 10px;
        }

        .likert-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            width: 18%;
        }

        .likert-num {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        .likert-desc {
            font-size: 12px;
            color: #999;
            text-align: center;
        }

        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            min-height: 100px;
            font-family: inherit;
            box-sizing: border-box;
        }

        .submit-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 18px;
            cursor: pointer;
            margin-top: 30px;
            transition: background 0.3s;
        }

        .submit-btn:hover {
            background-color: #1e4220;
        }

        .end-card {
            text-align: center;
            padding: 30px;
            background: #f9f9f9;
            border-radius: var(--border-radius);
            margin-top: 20px;
        }

        .end-card h2 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .progress-card {
            position: fixed;
            top: 120px;
            right: 24px;
            width: 220px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            padding: 16px;
            border: 1px solid #e7ece8;
            z-index: 20;
            cursor: grab;
            user-select: none;
        }

        .progress-card.dragging {
            cursor: grabbing;
        }

        .progress-title {
            font-weight: 600;
            font-size: 14px;
            margin: 0 0 8px;
            color: var(--primary-color);
        }

        .progress-meta {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        .progress-bar {
            height: 8px;
            background: #eef5ef;
            border-radius: 999px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            width: 0;
            background: linear-gradient(90deg, #2c5f2d 0%, #67a86a 100%);
            transition: width 0.3s ease;
        }

        .progress-tip {
            font-size: 12px;
            color: #7a8a7a;
            margin-top: 10px;
            line-height: 1.4;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 600px) {
            .container { padding: 15px; }
            .likert-desc { display: none; } /* æ‰‹æœºä¸Šéšè—æ–‡å­—æè¿°ï¼Œåªæ˜¾ç¤ºæ•°å­— */
            .likert-option:first-child .likert-desc, 
            .likert-option:last-child .likert-desc { display: block; } /* åªæ˜¾ç¤ºé¦–å°¾æè¿° */
        }

        @media (max-width: 1000px) {
            .progress-card { display: none; }
        }
    </style>
</head>
<body>

<aside class="progress-card" id="progressCard" aria-live="polite">
    <p class="progress-title">å¡«å†™è¿›åº¦</p>
    <div class="progress-meta">
        <span id="progressCount">0/0</span>
        <span id="progressPercent">0%</span>
    </div>
    <div class="progress-bar">
        <div class="progress-bar-fill" id="progressBarFill"></div>
    </div>
    <div class="progress-tip" id="progressTip">å…ˆå®Œæˆç­›é€‰é¢˜ï¼Œæ›´å¤šå†…å®¹å°†å±•å¼€ã€‚</div>
</aside>

<div class="container">
    <h1>æ»å·å¸‚åšç‰©é¦†æ¸¸å®¢æ»¡æ„åº¦è°ƒæŸ¥é—®å·</h1>
    
    <div class="intro">
        <p>æœ¬é—®å·ç”¨äº"æ–‡æ—…èåˆèƒŒæ™¯ä¸‹æ»å·å¸‚åšç‰©é¦†æ¸¸å®¢æ»¡æ„åº¦ç ”ç©¶"ï¼ŒåŒ¿åå¡«å†™ï¼Œæ•°æ®ä»…ç”¨äºå­¦æœ¯ç ”ç©¶ä¸è®ºæ–‡å†™ä½œã€‚<br>é™¤ç‰¹åˆ«è¯´æ˜å¤–å‡ä¸ºå•é€‰ï¼›æ»¡æ„åº¦é¢˜é‡‡ç”¨ 5 ç‚¹é‡è¡¨ï¼šéå¸¸ä¸æ»¡æ„ / ä¸æ»¡æ„ / ä¸€èˆ¬ / æ»¡æ„ / éå¸¸æ»¡æ„ã€‚</p>
    </div>

    <form id="surveyForm">

        <!-- ä¸€ã€ç­›é€‰é¢˜ -->
        <div class="section-title">ä¸€ã€ç­›é€‰é¢˜</div>

        <div class="question-block" id="q1-block">
            <label class="question-label">1. æ‚¨æ˜¯å¦å·²ç»å‚è§‚è¿‡æ»å·å¸‚åšç‰©é¦†ï¼ˆæœ¬æ¬¡æˆ–è¿‘æœŸï¼‰ï¼Ÿ<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q1" value="æ˜¯" required> æ˜¯ï¼ˆç»§ç»­ä½œç­”ï¼‰</label>
                <label class="radio-label"><input type="radio" name="Q1" value="å¦"> å¦ï¼ˆç»“æŸé—®å·ï¼‰</label>
            </div>
        </div>

        <!-- ç»“æŸå¡ç‰‡ï¼ˆç­›é€‰ä¸é€šè¿‡æ—¶æ˜¾ç¤ºï¼‰ -->
        <div id="endCard" class="end-card hidden">
            <h2>æ„Ÿè°¢é…åˆ ğŸ’«</h2>
            <p>æ‚¨é€‰æ‹©äº†"æœªå‚è§‚"ï¼Œé—®å·åˆ°æ­¤ç»“æŸã€‚</p>
        </div>

        <!-- ä»¥ä¸‹å†…å®¹åœ¨ç­›é€‰é€šè¿‡åæ˜¾ç¤º -->
        <div id="mainContent">

        <!-- äºŒã€å—è®¿è€…åŸºæœ¬ä¿¡æ¯ -->
        <div class="section-title">äºŒã€å—è®¿è€…åŸºæœ¬ä¿¡æ¯</div>

        <div class="question-block">
            <label class="question-label">2. æ‚¨çš„æ€§åˆ«ï¼š<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q2" value="ç”·" required> ç”·</label>
                <label class="radio-label"><input type="radio" name="Q2" value="å¥³"> å¥³</label>
                <label class="radio-label"><input type="radio" name="Q2" value="å…¶ä»–/ä¸ä¾¿é€éœ²"> å…¶ä»–/ä¸ä¾¿é€éœ²</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">3. æ‚¨çš„å¸¸ä½åœ°ï¼š<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q3" value="æ»å·æœ¬åœ°ï¼ˆå«å‘¨è¾¹åŒºå¿ï¼‰" required> æ»å·æœ¬åœ°ï¼ˆå«å‘¨è¾¹åŒºå¿ï¼‰</label>
                <label class="radio-label"><input type="radio" name="Q3" value="å®‰å¾½çœå†…å…¶ä»–åŸå¸‚"> å®‰å¾½çœå†…å…¶ä»–åŸå¸‚</label>
                <label class="radio-label"><input type="radio" name="Q3" value="çœå¤–"> çœå¤–</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">4. æ‚¨çš„å¹´é¾„æ®µï¼š<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q4" value="18å²ä»¥ä¸‹" required> 18å²ä»¥ä¸‹</label>
                <label class="radio-label"><input type="radio" name="Q4" value="18â€“25å²"> 18â€“25å²</label>
                <label class="radio-label"><input type="radio" name="Q4" value="26â€“35å²"> 26â€“35å²</label>
                <label class="radio-label"><input type="radio" name="Q4" value="36â€“45å²"> 36â€“45å²</label>
                <label class="radio-label"><input type="radio" name="Q4" value="46â€“60å²"> 46â€“60å²</label>
                <label class="radio-label"><input type="radio" name="Q4" value="60å²ä»¥ä¸Š"> 60å²ä»¥ä¸Š</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">5. æ‚¨çš„å—æ•™è‚²ç¨‹åº¦ï¼š<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q5" value="åˆä¸­åŠä»¥ä¸‹" required> åˆä¸­åŠä»¥ä¸‹</label>
                <label class="radio-label"><input type="radio" name="Q5" value="é«˜ä¸­/ä¸­ä¸“"> é«˜ä¸­/ä¸­ä¸“</label>
                <label class="radio-label"><input type="radio" name="Q5" value="å¤§ä¸“"> å¤§ä¸“</label>
                <label class="radio-label"><input type="radio" name="Q5" value="æœ¬ç§‘"> æœ¬ç§‘</label>
                <label class="radio-label"><input type="radio" name="Q5" value="ç ”ç©¶ç”ŸåŠä»¥ä¸Š"> ç ”ç©¶ç”ŸåŠä»¥ä¸Š</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">6. æ‚¨çš„èŒä¸šï¼š<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q6" value="å­¦ç”Ÿ" required> å­¦ç”Ÿ</label>
                <label class="radio-label"><input type="radio" name="Q6" value="ä¼äº‹ä¸šå•ä½èŒå‘˜"> ä¼äº‹ä¸šå•ä½èŒå‘˜</label>
                <label class="radio-label"><input type="radio" name="Q6" value="å…¬åŠ¡å‘˜/äº‹ä¸šç¼–"> å…¬åŠ¡å‘˜/äº‹ä¸šç¼–</label>
                <label class="radio-label"><input type="radio" name="Q6" value="è‡ªç”±èŒä¸š"> è‡ªç”±èŒä¸š</label>
                <label class="radio-label"><input type="radio" name="Q6" value="é€€ä¼‘"> é€€ä¼‘</label>
                <label class="radio-label"><input type="radio" name="Q6" value="å…¶ä»–"> å…¶ä»–</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">7. æ‚¨çš„æœˆæ”¶å…¥ï¼ˆæˆ–ç”Ÿæ´»è´¹ï¼‰æ°´å¹³ï¼š</label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q7" value="3000å…ƒä»¥ä¸‹"> 3000å…ƒä»¥ä¸‹</label>
                <label class="radio-label"><input type="radio" name="Q7" value="3001â€“6000å…ƒ"> 3001â€“6000å…ƒ</label>
                <label class="radio-label"><input type="radio" name="Q7" value="6001â€“10000å…ƒ"> 6001â€“10000å…ƒ</label>
                <label class="radio-label"><input type="radio" name="Q7" value="10001â€“15000å…ƒ"> 10001â€“15000å…ƒ</label>
                <label class="radio-label"><input type="radio" name="Q7" value="15000å…ƒä»¥ä¸Š"> 15000å…ƒä»¥ä¸Š</label>
                <label class="radio-label"><input type="radio" name="Q7" value="ä¸ä¾¿é€éœ²"> ä¸ä¾¿é€éœ²</label>
            </div>
        </div>

        <!-- ä¸‰ã€å‚è§‚ç‰¹å¾ä¸åŸºç¡€è®¤çŸ¥ -->
        <div class="section-title">ä¸‰ã€å‚è§‚ç‰¹å¾ä¸åŸºç¡€è®¤çŸ¥</div>

        <div class="question-block">
            <label class="question-label">8. æ‚¨æ­¤æ¬¡ä¸ºç¬¬å‡ æ¬¡å‚è§‚æ»å·å¸‚åšç‰©é¦†ï¼Ÿ<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q8" value="ç¬¬ä¸€æ¬¡" required> ç¬¬ä¸€æ¬¡</label>
                <label class="radio-label"><input type="radio" name="Q8" value="2â€“3æ¬¡"> 2â€“3æ¬¡</label>
                <label class="radio-label"><input type="radio" name="Q8" value="4æ¬¡åŠä»¥ä¸Š"> 4æ¬¡åŠä»¥ä¸Š</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">9. æ‚¨æœ¬æ¬¡å‚è§‚çš„ä¸»è¦ç›®çš„ï¼š<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q9" value="ä¼‘é—²å‚è§‚" required> ä¼‘é—²å‚è§‚</label>
                <label class="radio-label"><input type="radio" name="Q9" value="å­¦ä¹ ç ”å­¦"> å­¦ä¹ ç ”å­¦</label>
                <label class="radio-label"><input type="radio" name="Q9" value="é™ªåŒäº²å‹"> é™ªåŒäº²å‹</label>
                <label class="radio-label"><input type="radio" name="Q9" value="ç‰¹å±•/æ´»åŠ¨"> ç‰¹å±•/æ´»åŠ¨</label>
                <label class="radio-label"><input type="radio" name="Q9" value="å…¶ä»–"> å…¶ä»–</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">10. æ‚¨é€šè¿‡å“ªäº›é€”å¾„äº†è§£æ»å·å¸‚åšç‰©é¦†ï¼ˆæˆ–æœ¬æ¬¡å±•è®¯/æ´»åŠ¨ï¼‰ï¼Ÿ<span class="required-mark">*</span></label>
            <div class="question-help">å¯å¤šé€‰</div>
            <div class="options-group">
                <label class="checkbox-label"><input type="checkbox" name="Q10" value="äº²å‹æ¨è"> äº²å‹æ¨è</label>
                <label class="checkbox-label"><input type="checkbox" name="Q10" value="çŸ­è§†é¢‘/ç¤¾äº¤åª’ä½“"> çŸ­è§†é¢‘/ç¤¾äº¤åª’ä½“</label>
                <label class="checkbox-label"><input type="checkbox" name="Q10" value="æ—…æ¸¸å¹³å°/ç‚¹è¯„"> æ—…æ¸¸å¹³å°/ç‚¹è¯„</label>
                <label class="checkbox-label"><input type="checkbox" name="Q10" value="å­¦æ ¡/å•ä½ç»„ç»‡"> å­¦æ ¡/å•ä½ç»„ç»‡</label>
                <label class="checkbox-label"><input type="checkbox" name="Q10" value="å®˜ç½‘/å…¬ä¼—å·/å°ç¨‹åº"> å®˜ç½‘/å…¬ä¼—å·/å°ç¨‹åº</label>
                <label class="checkbox-label"><input type="checkbox" name="Q10" value="è·¯è¿‡çœ‹åˆ°"> è·¯è¿‡çœ‹åˆ°</label>
                <label class="checkbox-label"><input type="checkbox" name="Q10" value="å…¶ä»–"> å…¶ä»–</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">11. æ‚¨æœ¬æ¬¡ä¸»è¦å‡ºè¡Œæ–¹å¼ï¼š<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q11" value="æ­¥è¡Œ/è‡ªè¡Œè½¦" required> æ­¥è¡Œ/è‡ªè¡Œè½¦</label>
                <label class="radio-label"><input type="radio" name="Q11" value="å…¬äº¤"> å…¬äº¤</label>
                <label class="radio-label"><input type="radio" name="Q11" value="ç§å®¶è½¦/ç½‘çº¦è½¦"> ç§å®¶è½¦/ç½‘çº¦è½¦</label>
                <label class="radio-label"><input type="radio" name="Q11" value="å…¶ä»–"> å…¶ä»–</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">12. æ‚¨æœ¬æ¬¡å‚è§‚æ—¶é•¿å¤§çº¦ä¸ºï¼š<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q12" value="1å°æ—¶ä»¥å†…" required> 1å°æ—¶ä»¥å†…</label>
                <label class="radio-label"><input type="radio" name="Q12" value="1â€“2å°æ—¶"> 1â€“2å°æ—¶</label>
                <label class="radio-label"><input type="radio" name="Q12" value="2â€“3å°æ—¶"> 2â€“3å°æ—¶</label>
                <label class="radio-label"><input type="radio" name="Q12" value="3å°æ—¶ä»¥ä¸Š"> 3å°æ—¶ä»¥ä¸Š</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">13. æ‚¨æœ¬æ¬¡æ˜¯å¦å‚åŠ é¦†å†…è®²è§£/å¯¼è§ˆæœåŠ¡ï¼Ÿ<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q13" value="å‚åŠ äº†äººå·¥è®²è§£" required> å‚åŠ äº†äººå·¥è®²è§£</label>
                <label class="radio-label"><input type="radio" name="Q13" value="ä½¿ç”¨äº†è¯­éŸ³/æ‰«ç å¯¼è§ˆ"> ä½¿ç”¨äº†è¯­éŸ³/æ‰«ç å¯¼è§ˆ</label>
                <label class="radio-label"><input type="radio" name="Q13" value="æœªä½¿ç”¨"> æœªä½¿ç”¨</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">14. æ‚¨æœ¬æ¬¡æ˜¯å¦å‚ä¸åšç‰©é¦†ç»„ç»‡çš„ç¤¾æ•™/å…¬å…±æ–‡åŒ–æ´»åŠ¨ï¼Ÿï¼ˆè®²åº§ã€ç ”å­¦ã€å¯¼èµç­‰ï¼‰<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q14" value="æ˜¯" required> æ˜¯</label>
                <label class="radio-label"><input type="radio" name="Q14" value="å¦"> å¦</label>
            </div>
        </div>

        <div class="question-block">
            <label class="question-label">15. æ‚¨æœ¬æ¬¡æ˜¯å¦åœ¨æ–‡åˆ›åº—æ¶ˆè´¹ï¼Ÿ<span class="required-mark">*</span></label>
            <div class="options-group">
                <label class="radio-label"><input type="radio" name="Q15" value="æœ‰" required> æœ‰</label>
                <label class="radio-label"><input type="radio" name="Q15" value="æ²¡æœ‰"> æ²¡æœ‰</label>
            </div>
        </div>

        <!-- å››ã€æ»¡æ„åº¦æµ‹è¯„ -->
        <div class="section-title">å››ã€æ»¡æ„åº¦æµ‹è¯„</div>
        <p style="font-size: 12px; color: #666; text-align: center;">(5=éå¸¸æ»¡æ„ï¼Œ4=æ»¡æ„ï¼Œ3=ä¸€èˆ¬ï¼Œ2=ä¸æ»¡æ„ï¼Œ1=éå¸¸ä¸æ»¡æ„)</p>

        <div id="likert-questions-container"></div>

        <!-- äº”ã€è¡Œä¸ºæ„å‘ -->
        <div class="section-title">äº”ã€è¡Œä¸ºæ„å‘</div>
        <p style="font-size: 12px; color: #666; text-align: center;">(5=éå¸¸æ„¿æ„ï¼Œ4=æ„¿æ„ï¼Œ3=ä¸€èˆ¬ï¼Œ2=ä¸æ„¿æ„ï¼Œ1=éå¸¸ä¸æ„¿æ„)</p>

        <div id="intent-questions-container"></div>

        </div><!-- /mainContent -->

        <button type="submit" class="submit-btn">æäº¤é—®å·</button>

    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // æ»¡æ„åº¦é‡è¡¨é¢˜ç›®ï¼ˆQ16-Q36ï¼‰
    const likertQuestions = [
        // A æœ‰å½¢æ€§
        { id: "Q16", text: "16. æ‚¨å¯¹é¦†å†…ç¯å¢ƒæ•´æ´ä¸å«ç”ŸçŠ¶å†µæ˜¯å¦æ»¡æ„ï¼Ÿ", section: "A. æœ‰å½¢æ€§ Tangibles" },
        { id: "Q17", text: "17. æ‚¨å¯¹é¦†å†…æ¸©åº¦ã€é€šé£ä¸æ•´ä½“èˆ’é€‚åº¦æ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆå¦‚ç©ºè°ƒã€ç©ºæ°”æµé€šï¼‰" },
        { id: "Q18", text: "18. æ‚¨å¯¹æ— éšœç¢ä¸ä¾¿æ°‘è®¾æ–½æ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆç”µæ¢¯ã€æ¯å©´/è€äººå‹å¥½è®¾æ–½ã€é¥®æ°´ã€å¯„å­˜ç­‰ï¼‰" },
        { id: "Q19", text: "19. æ‚¨å¯¹é¦†å†…æŒ‡ç¤ºæ ‡è¯†ï¼ˆæ¥¼å±‚æŒ‡å¼•ã€å±•å…å¯¼å‘ã€è·¯çº¿æç¤ºï¼‰çš„æ¸…æ™°åº¦æ˜¯å¦æ»¡æ„ï¼Ÿ" },
        // B å¯é æ€§
        { id: "Q20", text: "20. æ‚¨å¯¹å¼€æ”¾æ—¶é—´æ‰§è¡Œä¸å…¥é¦†è§„åˆ™ï¼ˆå¦‚æ˜¯å¦å‡†æ—¶å¼€é—­é¦†ã€ç§©åºç¨³å®šï¼‰æ˜¯å¦æ»¡æ„ï¼Ÿ", section: "B. å¯é æ€§ Reliability" },
        { id: "Q21", text: "21. æ‚¨å¯¹å±•è§ˆä¿¡æ¯çš„å‡†ç¡®æ€§ä¸å®Œæ•´æ€§æ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆå±•å“è¯´æ˜ã€ä¸»é¢˜é˜é‡Šç­‰ï¼‰" },
        { id: "Q22", text: "22. æ‚¨å¯¹å¯¼è§ˆè§£è¯´å†…å®¹çš„å‡†ç¡®æ€§ã€ä¸“ä¸šæ€§ä¸ä¸€è‡´æ€§æ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆæ–‡å­—/è¯­éŸ³/äººå·¥ï¼‰" },
        // C å“åº”æ€§
        { id: "Q23", text: "23. æ‚¨å¯¹å·¥ä½œäººå‘˜/å¿—æ„¿è€…åœ¨å’¨è¯¢å¼•å¯¼æ—¶çš„å“åº”é€Ÿåº¦æ˜¯å¦æ»¡æ„ï¼Ÿ", section: "C. å“åº”æ€§ Responsiveness" },
        { id: "Q24", text: "24. æ‚¨å¯¹é«˜å³°æœŸæ’é˜Ÿç»„ç»‡ä¸äººæµç–å¯¼æ•ˆç‡æ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆå…¥å£ã€çƒ­é—¨å±•å…ç­‰ï¼‰" },
        { id: "Q25", text: "25. æ‚¨å¯¹ç°åœºé—®é¢˜å¤„ç†ä¸æŠ•è¯‰å»ºè®®åé¦ˆçš„åŠæ—¶æ€§æ˜¯å¦æ»¡æ„ï¼Ÿ" },
        // D ä¿è¯æ€§
        { id: "Q26", text: "26. æ‚¨å¯¹å·¥ä½œäººå‘˜æœåŠ¡æ€åº¦ä¸ç¤¼è²Œè§„èŒƒæ˜¯å¦æ»¡æ„ï¼Ÿ", section: "D. ä¿è¯æ€§ Assurance" },
        { id: "Q27", text: "27. æ‚¨å¯¹å·¥ä½œäººå‘˜ä¸šåŠ¡èƒ½åŠ›ä¸ä¸“ä¸šè§£ç­”æ°´å¹³æ˜¯å¦æ»¡æ„ï¼Ÿ" },
        { id: "Q28", text: "28. æ‚¨å¯¹å‚è§‚è¿‡ç¨‹ä¸­çš„å®‰å…¨æ„Ÿä¸ç§©åºæ„Ÿæ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆæ‹¥æŒ¤ç®¡ç†ã€æ–‡æ˜å‚è§‚å¼•å¯¼ç­‰ï¼‰" },
        // E ç§»æƒ…æ€§
        { id: "Q29", text: "29. æ‚¨å¯¹åšç‰©é¦†å¯¹ä¸åŒç¾¤ä½“çš„å…³æ€€ç¨‹åº¦æ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆè€äººã€å„¿ç«¥ã€è¡ŒåŠ¨ä¸ä¾¿è€…ç­‰ï¼‰", section: "E. ç§»æƒ…æ€§ Empathy" },
        { id: "Q30", text: "30. æ‚¨å¯¹æœåŠ¡æ˜¯å¦ä»¥æ¸¸å®¢ä¸ºä¸­å¿ƒçš„ä½“éªŒæ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆè€å¿ƒè§£é‡Šã€ä¸»åŠ¨å¸®åŠ©ã€å°Šé‡éœ€æ±‚ï¼‰" },
        { id: "Q31", text: "31. æ‚¨å¯¹å‚è§‚åŠ¨çº¿è®¾è®¡çš„äººæ€§åŒ–ç¨‹åº¦æ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆæ˜¯å¦æ˜“èµ°ã€æ˜“æ‡‚ã€å°‘ç»•è·¯ã€å°‘è¯¯å¯¼ï¼‰" },
        // F æ–‡æ—…èåˆä½“éªŒ
        { id: "Q32", text: "32. æ‚¨å¯¹å±•è§ˆæ˜¯å¦å……åˆ†ä½“ç°æ»å·åœ°æ–¹æ–‡åŒ–ç‰¹è‰²å¹¶å¢å¼ºæ–‡åŒ–è·å¾—æ„Ÿæ˜¯å¦æ»¡æ„ï¼Ÿ", section: "F. æ–‡æ—…èåˆä½“éªŒ" },
        { id: "Q33", text: "33. æ‚¨å¯¹äº’åŠ¨ä½“éªŒä¸æ™ºæ…§åŒ–ä½“éªŒæ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆæ•°å­—åŒ–å±•é¡¹ã€AR/VRã€æ‰«ç å¯¼è§ˆç­‰ï¼‰" },
        { id: "Q34", text: "34. æ‚¨å¯¹ç¤¾æ•™æ´»åŠ¨/å…¬å…±æ–‡åŒ–æ´»åŠ¨çš„ä½“éªŒæ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆè®²åº§ã€ç ”å­¦ã€å¯¼èµç­‰ï¼‰" },
        { id: "Q35", text: "35. æ‚¨å¯¹æ–‡åˆ›äº§å“çš„å¸å¼•åŠ›æ˜¯å¦æ»¡æ„ï¼Ÿï¼ˆç‰¹è‰²æ€§ã€ç§ç±»ä¸°å¯Œåº¦ã€æ€§ä»·æ¯”ç­‰ï¼‰" },
        // G æ€»ä½“æ»¡æ„åº¦
        { id: "Q36", text: "36. æ‚¨å¯¹æ»å·å¸‚åšç‰©é¦†çš„æ•´ä½“æ»¡æ„åº¦å¦‚ä½•ï¼Ÿ", section: "G. æ€»ä½“æ»¡æ„åº¦" }
    ];

    // è¡Œä¸ºæ„å‘é¢˜ç›®ï¼ˆQ37-Q38ï¼‰
    const intentQuestions = [
        { id: "Q37", text: "37. æœªæ¥æ‚¨æ„¿æ„å‘äº²å‹æ¨èæ»å·å¸‚åšç‰©é¦†ã€‚" },
        { id: "Q38", text: "38. æœªæ¥æ‚¨æ„¿æ„å†æ¬¡å‚è§‚æ»å·å¸‚åšç‰©é¦†ã€‚" }
    ];

    // åŠ¨æ€ç”Ÿæˆæ»¡æ„åº¦é‡è¡¨HTML
    const likertContainer = document.getElementById('likert-questions-container');
    if (likertContainer) {
        likertQuestions.forEach(q => {
            if (q.section) {
                const subtitle = document.createElement('div');
                subtitle.className = 'sub-section-title';
                subtitle.textContent = q.section;
                likertContainer.appendChild(subtitle);
            }
            const div = document.createElement('div');
            div.className = 'question-block';
            div.innerHTML = `
                <label class="question-label">${q.text}<span class="required-mark">*</span></label>
                <div class="likert-scale">
                    <label class="likert-option">
                        <span class="likert-num">5</span>
                        <input type="radio" name="${q.id}" value="5" required>
                        <span class="likert-desc">éå¸¸æ»¡æ„</span>
                    </label>
                    <label class="likert-option">
                        <span class="likert-num">4</span>
                        <input type="radio" name="${q.id}" value="4">
                        <span class="likert-desc">æ»¡æ„</span>
                    </label>
                    <label class="likert-option">
                        <span class="likert-num">3</span>
                        <input type="radio" name="${q.id}" value="3">
                        <span class="likert-desc">ä¸€èˆ¬</span>
                    </label>
                    <label class="likert-option">
                        <span class="likert-num">2</span>
                        <input type="radio" name="${q.id}" value="2">
                        <span class="likert-desc">ä¸æ»¡æ„</span>
                    </label>
                    <label class="likert-option">
                        <span class="likert-num">1</span>
                        <input type="radio" name="${q.id}" value="1">
                        <span class="likert-desc">éå¸¸ä¸æ»¡æ„</span>
                    </label>
                </div>
            `;
            likertContainer.appendChild(div);
        });
    }

    // åŠ¨æ€ç”Ÿæˆè¡Œä¸ºæ„å‘HTML
    const intentContainer = document.getElementById('intent-questions-container');
    if (intentContainer) {
        intentQuestions.forEach(q => {
            const div = document.createElement('div');
            div.className = 'question-block';
            div.innerHTML = `
                <label class="question-label">${q.text}<span class="required-mark">*</span></label>
                <div class="likert-scale">
                    <label class="likert-option">
                        <span class="likert-num">5</span>
                        <input type="radio" name="${q.id}" value="5" required>
                        <span class="likert-desc">éå¸¸æ„¿æ„</span>
                    </label>
                    <label class="likert-option">
                        <span class="likert-num">4</span>
                        <input type="radio" name="${q.id}" value="4">
                        <span class="likert-desc">æ„¿æ„</span>
                    </label>
                    <label class="likert-option">
                        <span class="likert-num">3</span>
                        <input type="radio" name="${q.id}" value="3">
                        <span class="likert-desc">ä¸€èˆ¬</span>
                    </label>
                    <label class="likert-option">
                        <span class="likert-num">2</span>
                        <input type="radio" name="${q.id}" value="2">
                        <span class="likert-desc">ä¸æ„¿æ„</span>
                    </label>
                    <label class="likert-option">
                        <span class="likert-num">1</span>
                        <input type="radio" name="${q.id}" value="1">
                        <span class="likert-desc">éå¸¸ä¸æ„¿æ„</span>
                    </label>
                </div>
            `;
            intentContainer.appendChild(div);
        });
    }

    // ç­›é€‰é¢˜é€»è¾‘
    const mainContent = document.getElementById('mainContent');
    const endCard = document.getElementById('endCard');
    const submitBtn = document.querySelector('.submit-btn');
    const progressCard = document.getElementById('progressCard');
    const progressCount = document.getElementById('progressCount');
    const progressPercent = document.getElementById('progressPercent');
    const progressBarFill = document.getElementById('progressBarFill');
    const progressTip = document.getElementById('progressTip');

    function clamp(value, min, max) {
        return Math.min(Math.max(value, min), max);
    }

    function initProgressCardDrag() {
        if (!progressCard) return;

        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let originLeft = 0;
        let originTop = 0;

        const onPointerDown = (event) => {
            if (event.button !== undefined && event.button !== 0) return;
            isDragging = true;
            progressCard.classList.add('dragging');

            const rect = progressCard.getBoundingClientRect();
            startX = event.clientX;
            startY = event.clientY;
            originLeft = rect.left;
            originTop = rect.top;

            progressCard.style.left = `${originLeft}px`;
            progressCard.style.top = `${originTop}px`;
            progressCard.style.right = 'auto';

            progressCard.setPointerCapture(event.pointerId);
        };

        const onPointerMove = (event) => {
            if (!isDragging) return;

            const deltaX = event.clientX - startX;
            const deltaY = event.clientY - startY;
            const nextLeft = originLeft + deltaX;
            const nextTop = originTop + deltaY;

            const maxLeft = window.innerWidth - progressCard.offsetWidth - 8;
            const maxTop = window.innerHeight - progressCard.offsetHeight - 8;

            progressCard.style.left = `${clamp(nextLeft, 8, maxLeft)}px`;
            progressCard.style.top = `${clamp(nextTop, 8, maxTop)}px`;
        };

        const onPointerUp = (event) => {
            if (!isDragging) return;
            isDragging = false;
            progressCard.classList.remove('dragging');
            progressCard.releasePointerCapture(event.pointerId);
        };

        progressCard.addEventListener('pointerdown', onPointerDown);
        progressCard.addEventListener('pointermove', onPointerMove);
        progressCard.addEventListener('pointerup', onPointerUp);
        progressCard.addEventListener('pointercancel', onPointerUp);
    }

    function getProgressTargetNames() {
        const names = new Set(['Q1']);
        const q1Value = document.querySelector('input[name="Q1"]:checked')?.value;

        if (q1Value === 'å¦') {
            return names;
        }

        document.querySelectorAll('#mainContent input[required]').forEach(input => {
            names.add(input.name);
        });

        names.add('Q10');
        return names;
    }

    function countAnswered(names) {
        let count = 0;
        names.forEach(name => {
            if (name === 'Q10') {
                if (document.querySelectorAll('input[name="Q10"]:checked').length > 0) {
                    count += 1;
                }
                return;
            }

            if (document.querySelector(`input[name="${name}"]:checked`)) {
                count += 1;
            }
        });

        return count;
    }

    function updateProgressCard() {
        const names = getProgressTargetNames();
        const total = names.size;
        const answered = countAnswered(names);
        const percent = total === 0 ? 0 : Math.round((answered / total) * 100);

        progressCount.textContent = `${answered}/${total}`;
        progressPercent.textContent = `${percent}%`;
        progressBarFill.style.width = `${percent}%`;

        if (answered === 0) {
            progressTip.textContent = 'å…ˆå®Œæˆç­›é€‰é¢˜ï¼Œæ›´å¤šå†…å®¹å°†å±•å¼€ã€‚';
        } else if (answered < total) {
            progressTip.textContent = 'å†åšæŒä¸€ä¸‹ï¼Œå³å°†å®Œæˆã€‚';
        } else {
            progressTip.textContent = 'å·²å®Œæˆå…¨éƒ¨å¿…ç­”é¢˜ï¼Œå¯æäº¤ã€‚';
        }
    }

    document.querySelectorAll('input[name="Q1"]').forEach(radio => {
        radio.addEventListener('change', function() {
            if (this.value === 'å¦') {
                mainContent.classList.add('hidden');
                endCard.classList.remove('hidden');
                submitBtn.textContent = 'æäº¤å¹¶ç»“æŸ';
            } else {
                mainContent.classList.remove('hidden');
                endCard.classList.add('hidden');
                submitBtn.textContent = 'æäº¤é—®å·';
            }

            updateProgressCard();
        });
    });

    document.getElementById('surveyForm').addEventListener('input', function() {
        updateProgressCard();
    });

    // è¡¨å•æäº¤å¤„ç†
    document.getElementById('surveyForm').addEventListener('submit', async function(e) {
        e.preventDefault();

        const formData = new FormData(this);
        const data = {};
        
        // æ”¶é›†å•é€‰é¢˜
        for (const [key, value] of formData.entries()) {
            if (data[key]) {
                // å¤šé€‰é¢˜ï¼šè½¬ä¸ºæ•°ç»„
                if (Array.isArray(data[key])) {
                    data[key].push(value);
                } else {
                    data[key] = [data[key], value];
                }
            } else {
                data[key] = value;
            }
        }

        // æ£€æŸ¥ç­›é€‰é¢˜
        if (data.Q1 === 'å¦') {
            // ç­›é€‰ä¸é€šè¿‡ï¼Œåªæäº¤Q1
            data.filtered = true;
        }

        // æ£€æŸ¥Q10å¤šé€‰é¢˜æ˜¯å¦è‡³å°‘é€‰ä¸€ä¸ªï¼ˆå¦‚æœä¸æ˜¯ç­›é€‰ç»“æŸï¼‰
        if (data.Q1 === 'æ˜¯') {
            const q10Checked = document.querySelectorAll('input[name="Q10"]:checked');
            if (q10Checked.length === 0) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªäº†è§£é€”å¾„ï¼ˆç¬¬10é¢˜ï¼‰');
                return;
            }
        }

        // å°†é‡è¡¨é¡¹è½¬æˆæ•°å­—ä¾¿äºåç«¯ç»Ÿè®¡
        [...likertQuestions, ...intentQuestions].forEach(q => {
            if (data[q.id]) {
                data[q.id] = Number(data[q.id]);
            }
        });

        try {
            const resp = await fetch('/api/surveys', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            const payload = await resp.json().catch(() => ({}));
            if (!resp.ok) {
                const msg = payload.message || 'æäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
                const detail = Array.isArray(payload.errors) ? `ï¼š${payload.errors.join('ï¼›')}` : '';
                throw new Error(msg + detail);
            }

            alert('âœ¨ é—®å·æäº¤æˆåŠŸï¼Œæ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼');
            this.reset();
            // é‡ç½®ç­›é€‰çŠ¶æ€
            mainContent.classList.remove('hidden');
            endCard.classList.add('hidden');
            submitBtn.textContent = 'æäº¤é—®å·';
            updateProgressCard();
        } catch (err) {
            console.error(err);
            alert('æäº¤å¤±è´¥ï¼š' + err.message);
        }
    });

    updateProgressCard();
    initProgressCardDrag();
});
</script>

</body>
</html>